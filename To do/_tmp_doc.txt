TrendSignal Hírek Minőségjavítása – Implementációs Stratégia Verzió: 2.0 | 2026-02-25 | Késleltetett források kizárva 1. Forrás Audit – Kizárások és Indoklás Day trading kontextusban a 15 percnél régebbi hír elveszíti mozgató erejét a piacon. A 12-24 órás híreket a time-decay modell már csak 35%-os súllyal veszi figyelembe, a napokkal korábbi híreknek pedig nulla relevanciájuk van. Ezen az alapon az alábbi forrásokat ki kell zárni a rendszerből. Forrás Dokumentált késés Valóság Döntés Indoklás NewsAPI (free) „24h delay&quot; Akár 1 hónapos KIZÁRVA Free tier törvényileg csak 1 hónapos archívumot ad Alpha Vantage (free) „0h&quot; (docs) Több órás-napos KIZÁRVA Valós idejűség csak fizetős csomagnál; 25 req/nap elfogy ⛔ A config.py-ban megmarad az API kulcsok tárolása, de a kollektorok collect_news() flow-ból kivételre kerülnek. A kód nem törlendő – fizetős upgrade esetén visszakapcsolható. 2. Aktív Forrás Tier Rendszer A kizárások után megmaradó forrásokat elérhetőség és limit szerint 3 tierbe soroljuk. Mindegyik forrás valós idejű vagy legfeljebb néhány perces látenciával dolgozik. Tier Forrás Valódi késés Limit Multi-ticker? Piac Tier 1 SEC EDGAR RSS &lt; 5 perc Korlátlan Igen (1 feed) US Tier 1 Nasdaq News RSS &lt; 5 perc Korlátlan Nem (ticker URL) US Tier 1 BÉT Tőzsdei RSS &lt; 5 perc Korlátlan Igen (1 feed) HU Tier 1 Seeking Alpha RSS &lt; 15 perc Korlátlan Nem (ticker URL) US Tier 1 Magyar RSS feedek &lt; 15 perc Korlátlan Igen (kulcsszó) HU Tier 1 Yahoo Finance RSS &lt; 15 perc Korlátlan* Nem (ticker URL) US Tier 2 Finnhub &lt; 2 perc 60 req/perc Nem US Tier 3 Marketaux &lt; 5 perc 100 req/nap Igen (batch) US Tier 3 GNews &lt; 5 perc 100 req/nap Nem US Tier 3 StockTwits &lt; 1 perc Korlátlan* Nem US ℹ️ *Yahoo Finance RSS megbízhatatlan polling-gal, de korlátlan – Tier 1 fallback pozícióban marad. ℹ️ *StockTwits alapszintű endpoint autentikáció nélkül is hozzáférhető, retail sentiment kiegészítőként. 3. Újonnan Beépítendő Ingyenes Források 3.1 SEC EDGAR RSS – US Corporate Events 8-K filingok valós időben: earnings, M&amp;A, management changes, material events. Egyetlen feed lefedi az összes US tickert – 1 request = 9 ticker. URL: https://www.sec.gov/cgi-bin/browse-edgar?action=getcurrent&amp;type=8-K&amp;dateb=&amp;owner=include&amp;count=40&amp;output=atom CIK-ticker mapping Python oldalon (AAPL→0000320193, TSLA→0001318605, stb.) Credibility: 0.95 – hivatalos tőzsdei dokumentum Különösen értékes: earnings surprise, insider trading, acquisition announce 3.2 Nasdaq News RSS Hivatalos tőzsdei hírek ticker-specifikus URL-eken keresztül. Napon belüli frissítéssel. URL: https://www.nasdaq.com/feed/rssoutbound?symbol=AAPL US tickerekre: AAPL, TSLA, MSFT, NVDA, META, AMZN, IBM Credibility: 0.90 3.3 BÉT Tőzsdei RSS Budapest Értéktőzsde hivatalos közleményei. A MOL.BD és OTP.BD esetén ez az egyetlen megbízható, valós idejű magyar pénzügyi forrás. URL: https://www.bet.hu/rss Corporate actions, közgyűlési döntések, osztalékbejelentések, profit figyelmeztetések Egyetlen feed → mindkét BÉT ticker egyszerre Credibility: 0.95 3.4 Seeking Alpha RSS Ticker-specifikus elemzések, jellemzően 0-2 órán belül megjelenő szakmai tartalom. URL: https://seekingalpha.com/symbol/AAPL.xml Gazdagabb szöveg → jobb FinBERT input Credibility: 0.82 3.5 StockTwits Retail social sentiment. Kontraindikátorként és megerősítőként is hasznos, különösen momentum-driven napokon. URL: https://api.stocktwits.com/api/2/streams/symbol/AAPL.json Autentikáció nélkül is elérhető, korlátlan alap endpoint Credibility: 0.50 – retail, de real-time 4. Batch Lekérdezés Optimalizáció 4.1 Marketaux – Multi-ticker Batch A Marketaux API egyetlen requestből kiszolgálja az összes US tickert. Ez a kizárások után még kritikusabbá válik, mivel a 100 napi limit most már az egyetlen rate-limited forrás. Jelenlegi (7 request/ciklus): GET /news/all?symbols=AAPL → 1 req GET /news/all?symbols=TSLA → 1 req ...összesen 7 req Optimalizált batch (1-2 request/ciklus): GET /news/all?symbols=AAPL,TSLA,MSFT,NVDA,META → 1 req GET /news/all?symbols=AMZN,IBM → 1 req Megtakarítás: ~72% (7 req → 2 req/ciklus) Napi kapacitás: 14 ciklus → ~50 ciklus A response entities mezőjéből ticker-specifikus sentiment_score kinyerhető szétosztáshoz. 4.2 SEC EDGAR + BÉT – Természetes Multi-ticker Ezek globális feedek: 1 request = az összes releváns ticker le van fedve. Nincs szükség batch koordinációra, a szűrés Python oldalon történik. SEC: 1 request → szűrés CIK mapping alapján → AAPL/TSLA/MSFT/... szétválaszt BÉT: 1 request → szűrés kulcsszó alapján → MOL.BD / OTP.BD szétválaszt 5. Fejlesztett Deduplikáció A kizárások után is maradnak átfedések: a Finnhub és Nasdaq RSS sokszor ugyanazt a Reuters/AP hírt adja vissza eltérő URL-en. A jelenlegi URL-alapú szűrés ezt nem fogja meg. 5.1 Jaccard Title-Similarity def _is_duplicate(item1, item2, threshold=0.80): words1 = set(item1.title.lower().split()) words2 = set(item2.title.lower().split()) jaccard = len(words1 &amp; words2) / len(words1 | words2) time_diff = abs((item1.published_at - item2.published_at).total_seconds()) return jaccard &gt;= threshold and time_diff &lt;= 1800 # 30 perc Konfliktus esetén a magasabb credibility score-ú forrás marad meg. Az alacsonyabb credibility-jű eldobandó, de az URL logolva marad audit célra. 6. Központi Quota Manager A NewsAPI és Alpha Vantage kizárásával egyszerűsödik a quota tracking: csak Marketaux (100/nap) és GNews (100/nap) igényel napi limitet, a Finnhub percenkénti limitet. 6.1 QuotaManager – src/quota_manager.py DAILY_LIMITS = { &quot;marketaux&quot;: 95, # 100/nap – 5 buffer &quot;gnews&quot;: 95, # 100/nap – 5 buffer } RATE_LIMITS = { &quot;finnhub&quot;: 55, # 60/perc – 5 buffer } SQLite perzisztencia: api_quotas(source, date, daily_count, last_reset) tábla. Backend újraindítás után sem vesznek el a számok. 7. Tier-Vezérelt Gyűjtő Logika A news_collector.py collect_news() metódusa az alábbi prioritási sorrendben dolgozik: def collect_news(ticker, company, lookback_hours): all_news = [] # TIER 1 – Korlátlan, mindig fut all_news += collect_sec_edgar(ticker) # 8-K filings all_news += collect_nasdaq_rss(ticker) # Nasdaq hírek all_news += collect_seeking_alpha_rss(ticker) all_news += collect_yahoo_rss(ticker) # fallback if ticker.endswith(&quot;.BD&quot;): all_news += collect_bet_rss(ticker) # BÉT közlemények all_news += collect_hungarian_rss(ticker) # TIER 2 – Rate-limited, de bőséges (60/perc) if quota.can_use(&quot;finnhub&quot;): all_news += collect_finnhub(ticker) # TIER 3 – Napi limit, csak ha Tier 1-2 nem elég if fresh_news_count(all_news, hours=2) &lt; MIN_FRESH_NEWS: if quota.can_use(&quot;marketaux&quot;) and is_batch_coordinator(ticker): all_news += batch_cache.get_for_ticker(ticker) # 1 req/9 ticker elif quota.can_use(&quot;gnews&quot;): all_news += collect_gnews(ticker) return deduplicate_advanced(all_news) ℹ️ MIN_FRESH_NEWS konfigurálható paraméter (config.py), alapértelmezett: 3 cikk az elmúlt 2 órában. 8. Implementációs Fázisok – Claude Code Feladatlista Fázis 1 – Kizárások (0.5 nap) news_collector.py: _collect_from_alphavantage() metódus hívása eltávolítása a collect_news() flow-ból news_collector.py: NewsAPI kollekció eltávolítása (ha még aktív) config.py: Érintett API kulcsok megtartása, de DISABLED megjegyzéssel jelölés Tesztelés: verify hogy a rendszer NewsAPI/AlphaVantage nélkül is elindul és hibát nem dob Fázis 2 – Quota Manager (1 nap) src/quota_manager.py létrehozása – QuotaManager osztály Marketaux + GNews + Finnhub tracking models.py: api_quotas tábla hozzáadása (source, date, daily_count, last_reset_at) Marketaux meglévő _daily_count mechanizmus migrálása QuotaManager-be QuotaManager injektálása news_collector.py-ba Fázis 3 – Ingyenes RSS Kollektorok (1-2 nap) src/rss_collector.py – SEC EDGAR collector: CIK mapping + feed parser src/rss_collector.py – Nasdaq RSS collector: ticker URL alapú src/rss_collector.py – BÉT RSS collector: kulcsszó alapú MOL/OTP szűrés src/rss_collector.py – Seeking Alpha RSS collector src/rss_collector.py – StockTwits collector (opcionális, alacsony prioritás) Credibility score-ok: SEC=0.95, BÉT=0.95, Nasdaq=0.90, SeekAlpha=0.82, StockTwits=0.50 Fázis 4 – Marketaux Batch Mód (0.5 nap) marketaux_collector.py: collect_batch(tickers: List[str]) metódus src/batch_news_cache.py: BatchNewsCache osztály TTL=900s (1 scheduler ciklus) Entity-alapú ticker szétosztás a batch response entities mezőjéből Koordináció: az első ticker triggereli a batch-et, a többi a cache-ből veszi Fázis 5 – Deduplikáció + Tier Integráció (1 nap) news_collector.py: _deduplicate_news() kiegészítése Jaccard title-similarity alapon news_collector.py: collect_news() átírása tier prioritási logikával config.py: MIN_FRESH_NEWS_COUNT paraméter hozzáadása (default: 3) End-to-end teszt: 9 ticker, quota exhaustion szimuláció, deduplikáció ellenőrzés 9. Várható Eredmény Metrika Jelenlegi Optimalizált Aktív hírforrások 5 (2 késleltetett) 8 (mind valós idejű) Legrégebbi hír a rendszerben Akár 1 hónap Max lookback_hours (config) Marketaux req/ciklus 7 req 1-2 req (batch) Marketaux napi kapacitás ~14 ciklus ~50 ciklus BÉT hírforrások 7 magyar RSS + BÉT tőzsdei RSS (official) US corporate event lefedettség Nincs SEC EDGAR real-time Duplikátum arány (becsült) ~30% &lt; 5% Napi plusz költség 0 Ft 0 Ft FinBERT terhelés (felesleges) Magas (régi hírek) Minimális 10. Érintett Fájlok Fájl Változás típusa Leírás Prioritás src/news_collector.py MÓDOSÍTÁS AlphaVantage/NewsAPI kizárása, tier logika, Jaccard dedup Kritikus src/quota_manager.py ÚJ Centrális quota tracking SQLite perzisztenciával Magas src/rss_collector.py ÚJ SEC EDGAR, Nasdaq, BÉT, Seeking Alpha, StockTwits Magas src/marketaux_collector.py MÓDOSÍTÁS collect_batch() metódus multi-ticker supporttal Magas src/batch_news_cache.py ÚJ TTL-alapú batch cache coordinator Közepes models.py MÓDOSÍTÁS api_quotas tábla hozzáadása Közepes src/config.py MÓDOSÍTÁS MIN_FRESH_NEWS_COUNT param, disabled API kulcsok jelölése Alacsony TrendSignal – Belső Fejlesztési Dokumentum | v2.0